{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/using-notion-as-a-content-manager-for-a-static-blog/","result":{"data":{"markdownRemark":{"html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8b20df98789231183503e88c190d138d/93719/0ca01e654f193b6555f25ba69613ee1ad67d8e71.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.47058823529413%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEEAv/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAABeyvEyQH/xAAbEAACAgMBAAAAAAAAAAAAAAACEQEDAAQSMf/aAAgBAQABBQKrp1UyJlw9fx5JS//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABkQAAIDAQAAAAAAAAAAAAAAAAABAhEhEP/aAAgBAQAGPwKSvGWzRvv/xAAdEAACAgEFAAAAAAAAAAAAAAAAARFBITFRYXGx/9oACAEBAAE/IUZCSnnZkjZV8jVJPQNDFux//9oADAMBAAIAAwAAABAv/wD/xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQMBAT8QAsv/xAAWEQEBAQAAAAAAAAAAAAAAAAABACH/2gAIAQIBAT8QVtv/xAAaEAEBAAMBAQAAAAAAAAAAAAABEQAhMUGh/9oACAEBAAE/EIqfF+GpgSUsD1m/ZRhrl4waMsac39zzTA7M/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"0ca01e654f193b6555f25ba69613ee1ad67d8e71.jpeg\"\n        title=\"0ca01e654f193b6555f25ba69613ee1ad67d8e71.jpeg\"\n        src=\"/static/8b20df98789231183503e88c190d138d/7bf67/0ca01e654f193b6555f25ba69613ee1ad67d8e71.jpg\"\n        srcset=\"/static/8b20df98789231183503e88c190d138d/651be/0ca01e654f193b6555f25ba69613ee1ad67d8e71.jpg 170w,\n/static/8b20df98789231183503e88c190d138d/d30a3/0ca01e654f193b6555f25ba69613ee1ad67d8e71.jpg 340w,\n/static/8b20df98789231183503e88c190d138d/7bf67/0ca01e654f193b6555f25ba69613ee1ad67d8e71.jpg 680w,\n/static/8b20df98789231183503e88c190d138d/990cb/0ca01e654f193b6555f25ba69613ee1ad67d8e71.jpg 1020w,\n/static/8b20df98789231183503e88c190d138d/c44b8/0ca01e654f193b6555f25ba69613ee1ad67d8e71.jpg 1360w,\n/static/8b20df98789231183503e88c190d138d/93719/0ca01e654f193b6555f25ba69613ee1ad67d8e71.jpg 4000w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Lately, I decided to create this static blog using the great GatsbyJs. Of course, a question quickly arose: what data source am I going to use to populate it?</p>\n<p>I really like Notion, I use it for note-taking, internal business documentation and I'll probably be using it to write my blog posts, so why not use it directly as a content manager?</p>\n<p>After searching the web for this idea, I came across a blog post by Tony Faieta:</p>\n<ul>\n<li><a href=\"https://medium.com/@tfaieta/how-i-use-notion-as-my-cms-for-my-gatsby-site-c449cc9a4687\">https://medium.com/@tfaieta/how-i-use-notion-as-my-cms-for-my-gatsby-site-c449cc9a4687</a></li>\n</ul>\n<p>I Decided to iterate over what he did.</p>\n<h2>Specs of the Project</h2>\n<ul>\n<li>I would like to have a root Notion note with a list of sub-notes that corresponds to all my blog posts. The root note is like the index of my blog.</li>\n<li>I would like my blog to import locally the notes from Notion.</li>\n<li>I would like my blog to import locally the images of the notes.</li>\n<li>I would like any video link to display well.</li>\n<li>\n<p>I would like my blog to regenerate a static website each time:</p>\n<ul>\n<li>I make a change on the code</li>\n<li>every day</li>\n<li>when I manually ask it to</li>\n</ul>\n</li>\n</ul>\n<h2>Importing Notes From Notion</h2>\n<p>To get the data from Notion, the most flexible tool I found is the <a href=\"https://github.com/jamalex/notion-py\">notion-py</a> python library. It allows getting notion note modelized as an array of blocks, each block being a text line, a title, an image, a list item, etc.</p>\n<p>I found markdown to be the best format to import Notion notes because the Gatsby plugin <a href=\"https://www.gatsbyjs.com/plugins/gatsby-transformer-remark/\">gatsby-transformer-remark</a> handles it very well and have itself a plugin to display all kinds of videos. Also, using markdown allows me to backup the posts easily.</p>\n<p>After a bit of hacking, I've made the following script: <a href=\"https://github.com/ArnaudValensi/ArnaudValensi.github.io/blob/master/bin/get-blog-posts.py\">get-blog-posts.py</a></p>\n<p>It uses two environment variables, <code class=\"language-text\">NOTION_TOKEN</code> and <code class=\"language-text\">NOTION_ROOT_PAGE_ID</code> which are respectively your notion token and the root page id.</p>\n<p>The notion token allows the library to access the private notes of your notion account, <a href=\"https://www.redgregory.com/notion/2020/6/15/9zuzav95gwzwewdu1dspweqbv481s5\">here</a> are the instructions to find it.</p>\n<p>To get the page id of your root page it's easy. If the link is <code class=\"language-text\">https://www.notion.so/Blog-83f4047341534d6bb846b1f561a13173</code>, the id is <code class=\"language-text\">83f4047341534d6bb846b1f561a13173</code>.</p>\n<p>The script will download any image URL. It will also convert any text line starting by <code class=\"language-text\">==</code> to a markdown metadata.</p>\n<p>Let's say you have this in your Notion note:</p>\n<div class=\"gatsby-highlight\" data-language=\"plaintext\"><pre class=\"language-plaintext\"><code class=\"language-plaintext\">== date: 2020-09-17\n== description: How to use notion as a content manager to generate a static blog.</code></pre></div>\n<p>In markdown it will become:</p>\n<div class=\"gatsby-highlight\" data-language=\"plaintext\"><pre class=\"language-plaintext\"><code class=\"language-plaintext\">---\ndate: 2020-09-17\ndescription: How to use Notion as a content manager to generate a static blog.\n---</code></pre></div>\n<p>The script stores the imported blog posts in the <code class=\"language-text\">content/blog/</code> directory. Then I tell the Gatsby remark plugin to generate the pages using the markdown files. At this point, the blog is running.</p>\n<h2>Continuous Deployment</h2>\n<p>I want to deploy on Github pages. To do this manually, we can use the npm package <a href=\"https://www.npmjs.com/package/gh-pages\">gh-pages</a> like this <code class=\"language-text\">gh-pages -d public</code>. This is nice, but I prefer to automate this part.</p>\n<p>I use a \"workflow\" made with <a href=\"https://github.com/features/actions\">Github Actions</a>.\nI create a <code class=\"language-text\">deploy.yml</code> file in the <code class=\"language-text\">.github/workflows</code> directory of my repository:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build and Deploy\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">schedule</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">cron</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"0 0 * * *\"</span> <span class=\"token comment\"># Every day at midnight.</span>\n  <span class=\"token key atrule\">workflow_dispatch</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> master\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build-and-deploy</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Set up Python 3.8\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>python@v2\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">python-version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3.8</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Set up pipenv\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> dschep/install<span class=\"token punctuation\">-</span>pipenv<span class=\"token punctuation\">-</span>action@v1\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> 2020.8.13\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout üõéÔ∏è\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2.3.2\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">persist-credentials</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install and Build üîß\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">NOTION_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.NOTION_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">NOTION_ROOT_PAGE_ID</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.NOTION_ROOT_PAGE_ID <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n          pipenv install\n          pipenv run python ./bin/get-blog-posts.py\n          yarn install\n          yarn build</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy üöÄ\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> JamesIves/github<span class=\"token punctuation\">-</span>pages<span class=\"token punctuation\">-</span>deploy<span class=\"token punctuation\">-</span>action@3.5.9\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">GITHUB_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.GITHUB_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">BRANCH</span><span class=\"token punctuation\">:</span> gh<span class=\"token punctuation\">-</span>pages\n          <span class=\"token key atrule\">FOLDER</span><span class=\"token punctuation\">:</span> public\n          <span class=\"token key atrule\">CLEAN</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p>In the <code class=\"language-text\">on:</code> section:</p>\n<ul>\n<li><code class=\"language-text\">schedule</code> tell to run this on a specific interval, here every day at midnight UTC.</li>\n<li><code class=\"language-text\">workflow_dispatch</code> allows you to have a button on your GitHub interface to manually trigger the deploy.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4b9d12cb31e3b60add14f22ea1146079/3145a/d35e209efa49a70204ce3d286270402b720b965f.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.11764705882354%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAABYlAAAWJQFJUiTwAAACOElEQVQoz3VRS08TURSe3+MCE9GApKSVIoom/huXrk3YkeDan+DChcYNEBWp5dVCX9BpETrtPDrPO3Pfd65niglJE0/OfDmZe79zvnM/o7K++fL1m+rGZvXFq1J5rVR+9nS1Uq5uLJery6trpcrzlfL6Srm6sLj04OHju1x4Unq0tLq4VDLO251a4/Lw7KrevNw/6u4f9XZ/d37Vu/1evz8YmoNrczC87JvHp43mRbvV6Z42zlvtDmC70zNUrlHGUiKSjGZUeAhHVxO/3sNNk966RAjGBBcSpRnnAhMKqbWWKs9zbTAhMeNcqQRzzARTIvcCMbTE9YRNI1qQOdBmUKCQEshKKSGkkTMiIj9XXBGuOY+ottPcDwPH91GWpUUg+DKoEYJxGSauN8WYAN/48bn7duvk/U7j3XZra/sstfwIszRBlFC4qv7FrAChIFjKmVAFtTFqO3s/JweH9u73ce1g7Fu27drWeALD9H8CmoJmQGPuAFaKk4QQClIpvR8uJZwIIThMJoyFcSKUNIo+qkglc53rIM7MkefFJEDcR2yaUC+mQcrdmDgRsQPs+pljh44TR1F2Pzmf4SSW5yPcsrLW+A5J8wZ1HTYM877PB7G2bpD/7cT5UkMnw3nZIGviTlGGaeEqg2SgVWmUkMTyUZAU/goFRksu5smwXlBEyBmDRWfuCvjfrdc+fvpQ3/uqVaERWkip5snwHrbj/rm59bwpZay4NVsovB11Lo4d0wSjwigG3+EB/wJZ/rJgqkHp+gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"d35e209efa49a70204ce3d286270402b720b965f.png\"\n        title=\"d35e209efa49a70204ce3d286270402b720b965f.png\"\n        src=\"/static/4b9d12cb31e3b60add14f22ea1146079/c5bb3/d35e209efa49a70204ce3d286270402b720b965f.png\"\n        srcset=\"/static/4b9d12cb31e3b60add14f22ea1146079/04472/d35e209efa49a70204ce3d286270402b720b965f.png 170w,\n/static/4b9d12cb31e3b60add14f22ea1146079/9f933/d35e209efa49a70204ce3d286270402b720b965f.png 340w,\n/static/4b9d12cb31e3b60add14f22ea1146079/c5bb3/d35e209efa49a70204ce3d286270402b720b965f.png 680w,\n/static/4b9d12cb31e3b60add14f22ea1146079/b12f7/d35e209efa49a70204ce3d286270402b720b965f.png 1020w,\n/static/4b9d12cb31e3b60add14f22ea1146079/b5a09/d35e209efa49a70204ce3d286270402b720b965f.png 1360w,\n/static/4b9d12cb31e3b60add14f22ea1146079/3145a/d35e209efa49a70204ce3d286270402b720b965f.png 2112w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></li>\n<li><code class=\"language-text\">push</code> allows you to trigger the deploy on a specific branch push.</li>\n</ul>\n<p>Then the script does the following deploy steps:</p>\n<ul>\n<li>it creates a virtual machine with the latest ubuntu</li>\n<li>it setups python 3.8</li>\n<li>it adds pipenv to install the same versions of the python packages as in development</li>\n<li>it gets the code of the repository</li>\n<li>it sets the environment variables and runs the commands to import the blog posts and build the static website</li>\n<li>it deploys on GitHub pages</li>\n</ul>\n<p>And we're all set. We can now create our blog posts inside Notion. When we are done editing the post, we can move the note in the root note and either wait the next day to publish it or go in the GitHub interface to ask a rebuild and the blog gets updated. I really enjoy this workflow because there is very little friction to go from a note to a blog post.</p>\n<p>The source code of this blog is available here <a href=\"https://github.com/ArnaudValensi/ArnaudValensi.github.io\">https://github.com/ArnaudValensi/ArnaudValensi.github.io</a></p>\n<p>Thank you for reading and tell me in the comments what is your preferred way to edit a blog.</p>","frontmatter":{"title":"Using Notion As a Content Manager for a Static Blog","description":"How to use notion as a content manager to generate a static blog."}}},"pageContext":{"slug":"/using-notion-as-a-content-manager-for-a-static-blog/","previousPost":null,"nextPost":null}},"staticQueryHashes":["3868140423","63159454"]}